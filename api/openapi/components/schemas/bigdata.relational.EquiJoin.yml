allOf:
  - $ref: ./bigdata.relational.Operation.yml
  - type: object
    description: |-
      Equi-join operation.

      Joins rows of 2 different tables by an equality on column(s).

      The resulting schema will be:

      | Columns of table1 ... | Columns of table2 - Keys of table2... |

      Therefore the columns of table2 that are not used as keys should have
      different names from the columns of table1. If that is not the case,
      a rename operation is required prior to the join.

      Example:
      considering these two tables and their column names:
      table1           table2
      colA colB colC   colD colE

      The resulting table of an equi join on colAB and colD:
      table Result
      colA colB colC colE
    required:
      - refs
    properties:
      table1:
        description: Tables to join.
        oneOf:
          - $ref: ./bigdata.aggr.Average.yml
          - $ref: ./bigdata.aggr.Count.yml
          - $ref: ./bigdata.aggr.CountRows.yml
          - $ref: ./bigdata.aggr.CountUnique.yml
          - $ref: ./bigdata.aggr.Empty.yml
          - $ref: ./bigdata.aggr.Max.yml
          - $ref: ./bigdata.aggr.Min.yml
          - $ref: ./bigdata.aggr.MultiAggregation.yml
          - $ref: ./bigdata.aggr.Quantiles.yml
          - $ref: ./bigdata.aggr.Sum.yml
          - $ref: ./bigdata.mde.AddFields.yml
          - $ref: ./bigdata.mde.Complete.yml
          - $ref: ./bigdata.mde.CsvData.yml
          - $ref: ./bigdata.mde.DefaultRows.yml
          - $ref: ./bigdata.mde.DefaultTable.yml
          - $ref: ./bigdata.mde.EquiJoin.yml
          - $ref: ./bigdata.mde.FlexibleUnion.yml
          - $ref: ./bigdata.mde.GenerateTicks.yml
          - $ref: ./bigdata.mde.Input.yml
          - $ref: ./bigdata.mde.Merge.yml
          - $ref: ./bigdata.mde.Mux.yml
          - $ref: ./bigdata.mde.Partial.yml
          - $ref: ./bigdata.mde.Product.yml
          - $ref: ./bigdata.mde.StaticData.yml
          - $ref: ./bigdata.mde.Trace.yml
          - $ref: ./bigdata.mde.Unique.yml
          - $ref: ./bigdata.mde.Void.yml
          - $ref: ./bigdata.relational.Clip.yml
          - $ref: ./bigdata.relational.CollectionTable.yml
          - $ref: ./bigdata.relational.EquiJoin.yml
          - $ref: ./bigdata.relational.ForEachRow.yml
          - $ref: ./bigdata.relational.Grouping.yml
          - $ref: ./bigdata.relational.ListTable.yml
          - $ref: ./bigdata.relational.MapReduce.yml
          - $ref: ./bigdata.relational.Mux.yml
          - $ref: ./bigdata.relational.NamedTableReference.yml
          - $ref: ./bigdata.relational.OperationChain.yml
          - $ref: ./bigdata.relational.PlaceholderTable.yml
          - $ref: ./bigdata.relational.Projection.yml
          - $ref: ./bigdata.relational.Reduce.yml
          - $ref: ./bigdata.relational.Rename.yml
          - $ref: ./bigdata.relational.Selection.yml
          - $ref: ./bigdata.relational.Skip.yml
          - $ref: ./bigdata.relational.Sort.yml
          - $ref: ./bigdata.relational.Union.yml
          - $ref: ./bigdata.relational.WithNamedTables.yml
          - $ref: ./one.bte.BestTimeRangeOp.yml
          - $ref: ./one.geomarketing.CrmMapper.yml
          - $ref: ./one.geomarketing.CrmMultiMapper.yml
          - $ref: ./one.geomarketing.DimensionMapper.yml
          - $ref: ./one.geomarketing.RecurrenceFilter.yml
          - $ref: ./one.geomarketing.RelativeTimeMap.yml
          - $ref: ./one.geomarketing.StatRefinement.yml
          - $ref: ./one.geomarketing.TimeMap.yml
          - $ref: ./one.geomarketing.ZoneMap.yml
          - $ref: ./one.geoutils.CgiToCoords.yml
          - $ref: ./one.geoutils.CgiToCoordsSmoothed.yml
          - $ref: ./one.geoutils.EventFilter.yml
          - $ref: ./one.geoutils.EventFilterListRemovals.yml
          - $ref: ./one.geoutils.GridMap.yml
          - $ref: ./one.geoutils.MultiGridMap.yml
          - $ref: ./one.geoutils.clustering.Geoleader.yml
          - $ref: ./one.geoutils.mvp.MvpChanges.yml
          - $ref: ./one.geoutils.mvp.MvpChangesFromStops.yml
          - $ref: ./one.geoutils.stopsegment.MergeShortStops.yml
          - $ref: ./one.geoutils.stopsegment.StopSegmentLegacy.yml
          - $ref: ./one.timeutils.MergeStays.yml
          - $ref: ./one.timeutils.SplitTimeInterval.yml
          - $ref: ./one.timeutils.StopsToNights.yml
          - $ref: ./one.timeutils.TimeRangeOverlaps.yml
        discriminator:
          propertyName: _class
      table2:
        oneOf:
          - $ref: ./bigdata.aggr.Average.yml
          - $ref: ./bigdata.aggr.Count.yml
          - $ref: ./bigdata.aggr.CountRows.yml
          - $ref: ./bigdata.aggr.CountUnique.yml
          - $ref: ./bigdata.aggr.Empty.yml
          - $ref: ./bigdata.aggr.Max.yml
          - $ref: ./bigdata.aggr.Min.yml
          - $ref: ./bigdata.aggr.MultiAggregation.yml
          - $ref: ./bigdata.aggr.Quantiles.yml
          - $ref: ./bigdata.aggr.Sum.yml
          - $ref: ./bigdata.mde.AddFields.yml
          - $ref: ./bigdata.mde.Complete.yml
          - $ref: ./bigdata.mde.CsvData.yml
          - $ref: ./bigdata.mde.DefaultRows.yml
          - $ref: ./bigdata.mde.DefaultTable.yml
          - $ref: ./bigdata.mde.EquiJoin.yml
          - $ref: ./bigdata.mde.FlexibleUnion.yml
          - $ref: ./bigdata.mde.GenerateTicks.yml
          - $ref: ./bigdata.mde.Input.yml
          - $ref: ./bigdata.mde.Merge.yml
          - $ref: ./bigdata.mde.Mux.yml
          - $ref: ./bigdata.mde.Partial.yml
          - $ref: ./bigdata.mde.Product.yml
          - $ref: ./bigdata.mde.StaticData.yml
          - $ref: ./bigdata.mde.Trace.yml
          - $ref: ./bigdata.mde.Unique.yml
          - $ref: ./bigdata.mde.Void.yml
          - $ref: ./bigdata.relational.Clip.yml
          - $ref: ./bigdata.relational.CollectionTable.yml
          - $ref: ./bigdata.relational.EquiJoin.yml
          - $ref: ./bigdata.relational.ForEachRow.yml
          - $ref: ./bigdata.relational.Grouping.yml
          - $ref: ./bigdata.relational.ListTable.yml
          - $ref: ./bigdata.relational.MapReduce.yml
          - $ref: ./bigdata.relational.Mux.yml
          - $ref: ./bigdata.relational.NamedTableReference.yml
          - $ref: ./bigdata.relational.OperationChain.yml
          - $ref: ./bigdata.relational.PlaceholderTable.yml
          - $ref: ./bigdata.relational.Projection.yml
          - $ref: ./bigdata.relational.Reduce.yml
          - $ref: ./bigdata.relational.Rename.yml
          - $ref: ./bigdata.relational.Selection.yml
          - $ref: ./bigdata.relational.Skip.yml
          - $ref: ./bigdata.relational.Sort.yml
          - $ref: ./bigdata.relational.Union.yml
          - $ref: ./bigdata.relational.WithNamedTables.yml
          - $ref: ./one.bte.BestTimeRangeOp.yml
          - $ref: ./one.geomarketing.CrmMapper.yml
          - $ref: ./one.geomarketing.CrmMultiMapper.yml
          - $ref: ./one.geomarketing.DimensionMapper.yml
          - $ref: ./one.geomarketing.RecurrenceFilter.yml
          - $ref: ./one.geomarketing.RelativeTimeMap.yml
          - $ref: ./one.geomarketing.StatRefinement.yml
          - $ref: ./one.geomarketing.TimeMap.yml
          - $ref: ./one.geomarketing.ZoneMap.yml
          - $ref: ./one.geoutils.CgiToCoords.yml
          - $ref: ./one.geoutils.CgiToCoordsSmoothed.yml
          - $ref: ./one.geoutils.EventFilter.yml
          - $ref: ./one.geoutils.EventFilterListRemovals.yml
          - $ref: ./one.geoutils.GridMap.yml
          - $ref: ./one.geoutils.MultiGridMap.yml
          - $ref: ./one.geoutils.clustering.Geoleader.yml
          - $ref: ./one.geoutils.mvp.MvpChanges.yml
          - $ref: ./one.geoutils.mvp.MvpChangesFromStops.yml
          - $ref: ./one.geoutils.stopsegment.MergeShortStops.yml
          - $ref: ./one.geoutils.stopsegment.StopSegmentLegacy.yml
          - $ref: ./one.timeutils.MergeStays.yml
          - $ref: ./one.timeutils.SplitTimeInterval.yml
          - $ref: ./one.timeutils.StopsToNights.yml
          - $ref: ./one.timeutils.TimeRangeOverlaps.yml
        discriminator:
          propertyName: _class
      refs:
        type: array
        description: |-
          References to evaluate.

          A row from table1 will be joined with a row from table 2 if all the
          evalulated refs (columns) values are equal.
        items:
          $ref: ./bigdata.relational.EvaluatedRefs.yml
        minItems: 1
      method:
        description: Method used to join the records.
        allOf:
          - $ref: ./bigdata.relational.JoinMethod.yml
        default: 0
      inhibitCondPropagationLeft:
        type: boolean
        description: Do not propagate input condition on the left table.
        nullable: true
      inhibitCondPropagationRight:
        type: boolean
        description: Do not propagate input condition on the right table.
        nullable: true
      optimizeRightExtract:
        type: boolean
        description: |-
          Optimize extracts made on the right table (table2).

          This parameter can be used when extracting data on the right table
          (table2) is significantly slower than on the left table (table 1).

          When set, the join is rewritten in a way that the extraction is first
          performed on the left table, and then only the lines matching the
          extracted keys from the left table are extracted from the right table,
          ensuring the amount of extracted data is as small as possible.
        nullable: true
